from IPython.display import HTML
import webbrowser
import warnings
import json
import ast
import pandas as pd

from mstr_robotics.navigation import answer_prompts, mstr_objects
from mstr_robotics.prepare_AI_data import map_objects
from openai import OpenAI
from mstr_robotics.mstr_classes import mstr_global
from mstr_robotics.dossier import doss_read_out
from mstr_robotics._helper import msic
from mstr_robotics._connectors import mstr_api
from mstr_robotics.report import rep, prompts, cube

from mstrio.connection import Connection

from mstr_robotics.mstr_pandas import df_helper
from mstr_robotics.user_RAG import keyword_processor, vectorDB_faisst,mstr_openAI,chat_bot, perplexity
pd.set_option('display.max_colwidth', None)      # No limit on column width
pd.set_option('display.max_rows', None)          # Show all rows
pd.set_option('display.max_columns', None)       # Show all columns
pd.set_option('display.width', 0)                # Auto-adjust to terminal

user_path=".\\config\\user_d.json"
with open(user_path, 'r') as file:
    user_d = json.load(file)

conn_params =  user_d["conn_params"]
sKey=user_d["sKey"]
conn_params["project_id"]="B7CA92F04B9FAE8D941C3E9B7E0CD754"
conn = Connection(**conn_params)
conn.headers['Content-type'] = "application/json"

i_doss_read_out=doss_read_out()

dossier_id_l=['91EAACA611E5CEB600000080EF65DC57',
 'BDDD9C9D11E5CEB6281D0080EFB57B56',
 'DED74CE111E5CEB6227C0080EFD5BD58',
 'FE72F33B11E7F54F000000802F31418D',
 'E0E776C511E7A7A721B60080EF95E510',
 '91D47A3F4E475AFC2C9444957BF2B7A0',
 '52576385422A3F9F174B97BE6E361116',
 '9117080211E751F91DB80080EFC5029E',
 'ACC0564A11E6E85D38370080EF7539CF',
 'ECA017A611E6B18900000080EF95ED4B',
 '3511C9E011E5983A85B30080EFE560D9',
 '69F662EE11E9817800000080AFE34811',
 'D09703544A3A224C570D7FBC1861DE1F',
 'EEEA0A8211E5983D03560080EFA5623F',
 '4480640B11EAF10334D90080EF950B74',
 '0D0CDC8F11E97E8F00000080AFB3A407',
 'EAF770F9CD46F277F7B36588C3425B94',
 'E97AD91E11E7B9AB2AB30080EF25F216',
 '3850EDC911E5A8F4045C0080EF95C044',
 'CEDEA2B411E8020F86710080EF656C28',
 '773D16274722D01CDAF373B903CD6DEA',
 '98EB31B54122FFB738E6E08A2F29421A',
 'C7AAF6B34AF39F158743F4A06220A75F',
 'DE9B18B911E8021400000080AF9146C5',
 '3D5AD91611E8285C3D690080EFA5ACC6',
 '5F60915D11E66A3211E60080EF215528',
 '3F15E6D111E7E02F00000080AF71B1B4',
 '8CB1914B11E66AF285A80080EF1E255B',
 '27BB740E11E7A7B40A650080EF856B88',
 '6F06E64011E5983903900080EF75023F',
 '1687A36449FBD4F6CD55A987AD3B98F2',
 '93A71A3711E8021000000080AF9146C5',
 '4C4BB57C11EB4EFF96550080EF952010',
 'F2D7D4DE11E751F600000080EF5523A2',
 '2C68268711E7933800000080AFB1D2B9',
 'FD0A8B8A11E75A9400000080EF75153D',
 'C4556F1011EA16CDC3790080EF85ADB0',
 'BDC3CA6811E7F6E342400080EFF58353',
 'F7BFC1FB11E5983903900080EF95413D',
 'E1D0DC7811E6C2D900000080EF751161',
 '3D95453211E5984003730080EF55C23E',
 '316401E111E6BD5BAD440080EFE1DC37',
 '0B38895711E79D7ECFF20080AFB1518B',
 '32765C5C11E79D5927C10080EF753106',
 '7ED2BBCF11E680345A810080EFBE8942',
 '69E7F9AA11E5983F03900080EF45A13C',
 '4802DE4C4C18F434C75BFA84EC8A5E4B',
 'C643022211E6C2E000000080EF359160',
 'F6252B9211E7B348312C0080EF55DB6A',
 'B353A2814785510D8C87C7891D7DFC04',
 'AAC8F71911E5983E03730080EFC5A23D',
 '8F7FAE30443F2A183832E4A013AFD563',
 '80FDE73E4A791F63F91F9384708FA258',
 'FC53DDBF4CF41D2B365248BA5150C9D4',
 'EB8D6D864ACB2F3DFD71BAA5AC1FED20',
 '9542AE534183F45A449E1DB5923F786C',
 'DA0B39F911E7A94B00000080AF11FAC4',
 'CF13BCDA409911243371CA980BAAE749',
 '3AB0F59211E7F49A736B0080EFD51CF3',
 '11EA496611E751FB1E9A0080EF25C29E',
 '5CE7870C4629D0FF46C67FB242D6DDB8',
 'F44B15734DFC41B2575DBB8F6CE1D4EB',
 '4C5A42DD11E75A9777F70080EF05353C',
 '3BDFDB0611E79D59276F0080EF753106',
 '4B5DC56611E79D5928350080EF753106',
 '7889DA8011E93B9525050080EF55EFEA',
 '371E250C11E5BEFB00000080EF85899C',
 '19A95FA711EC45A93E0B0080AFAB8FDF',
 'BDD72BE311EAA41CD7700080EFD5E527',
 '1532D3684B9D88716CFFAA921CA17458',
 '9185F53611E48213000000802F179505',
 '8B3BFEAC11E5BEFB00000080EF95A99C']

doss_filt_d=i_doss_read_out.run_read_out_doss_filt_sel(conn,dossier_id_l)

